<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Lifewood AI</title>
    <link rel="icon" href="icon.png" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;700;800&family=Lora:wght@400;500;700&display=swap" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <style>
    :root {
        --brand-green: #0a5441;
        --brand-saffron: #FFB347;
        --brand-green-light: #e6f0ed;
        --bg-color: #f7f7f7;
        --card-bg-color: #ffffff;
        --sidebar-bg: #ffffff;
        --primary-blue: var(--brand-green);
        --primary-blue-light: var(--brand-green-light);
        --text-dark: #333333;
        --text-light: #6b7280;
        --border-color: #e0e0e0;
        --green: #10b981;
        --red: #ef4444;
    }
    body.dark-mode {
        --bg-color: #111827;
        --card-bg-color: #1f2937;
        --sidebar-bg: #1f2937;
        --primary-blue-light: #113c30;
        --text-dark: #f4f4f4;
        --text-light: #9ca3af;
        --border-color: #374151;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Manrope', sans-serif; background-color: var(--bg-color); color: var(--text-dark); display: flex; }
    #toast-container { position: fixed; bottom: 20px; right: 20px; z-index: 1050; display: flex; flex-direction: column; gap: 10px; }
    .toast { padding: 12px 20px; background-color: #2d3748; color: white; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); display: flex; align-items: center; gap: 10px; opacity: 0; transform: translateY(20px); animation: toast-in 0.5s forwards; }
    .toast.success { background-color: var(--green); }
    .toast.error { background-color: var(--red); }
    .toast i { font-size: 20px; }
    @keyframes toast-in { to { opacity: 1; transform: translateY(0); } }
    .sidebar { width: 260px; background-color: var(--sidebar-bg); padding: 24px; display: flex; flex-direction: column; border-right: 1px solid var(--border-color); height: 100vh; position: fixed; z-index: 100; }
    .sidebar .logo .logo-image { height: 50px; width: auto; }
    .sidebar .nav-item { display: flex; align-items: center; padding: 14px 18px; border-radius: 8px; text-decoration: none; color: var(--text-light); font-weight: 600; margin-bottom: 8px; cursor: pointer; }
    .sidebar .nav-item i { font-size: 22px; margin-right: 16px; }
    .sidebar .nav-item.active, .sidebar .nav-item:hover { background-color: var(--primary-blue-light); color: var(--primary-blue); }
    .sidebar .logout-btn { margin-top: auto; background: none; border: none; width: 100%; }
    .main-content { flex-grow: 1; margin-left: 260px; padding: 24px 32px; }
    .main-page { display: none; }
    .main-page.active { display: block; }
    .page-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px; }
    .page-header .greeting h1 { font-family: 'Lora', serif; font-size: 28px; font-weight: 700; color: var(--brand-green); }
    .page-header .greeting p { color: var(--text-light); }
    .widget-card { background-color: var(--card-bg-color); padding: 24px; border-radius: 12px; border: 1px solid var(--border-color); }
    h2.section-title { font-family: 'Lora', serif; font-size: 22px; font-weight: 700; margin-bottom: 24px; color: var(--brand-green); }
    .dashboard-widgets { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 24px; margin-bottom: 32px; }
    .widget-card h3 { color: var(--text-light); font-size: 14px; font-weight: 600; margin-bottom: 8px; }
    .widget-card .count { font-size: 36px; font-weight: 800; }
    .application-section { background-color: var(--card-bg-color); border-radius: 12px; padding: 24px; border: 1px solid var(--border-color); }
    .tabs { display: flex; border-bottom: 1px solid var(--border-color); }
    .tab-button { padding: 12px 20px; cursor: pointer; background: none; border: none; font-size: 14px; font-weight: 600; color: var(--text-light); position: relative; border-bottom: 2px solid transparent; margin-bottom: -1px; }
    .tab-button.active, .tab-button:hover { color: var(--primary-blue); border-bottom-color: var(--primary-blue); }
    .tab-content { display: none; margin-top: 24px; }
    .tab-content.active { display: block; }
    .application-table { width: 100%; border-collapse: collapse; table-layout: fixed; }
    .application-table th, .application-table td { padding: 16px; text-align: left; border-bottom: 1px solid var(--border-color); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .application-table th { font-size: 12px; text-transform: uppercase; color: var(--text-light); }
    .application-table a { color: var(--primary-blue); font-weight: 600; text-decoration: none; }
    .action-btn { padding: 8px 12px; border-radius: 6px; cursor: pointer; border: none; font-weight: 700; font-size: 12px; margin-right: 5px; }
    .accept-btn { background-color: #d1fae5; color: #065f46; }
    .reject-btn { background-color: #fee2e2; color: #b91c1c; }
    .no-apps-message { text-align: center; padding: 50px; color: var(--text-light); }
    .employee-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 24px; }
    .employee-card { text-align: center; padding: 24px; }
    .employee-card img { width: 100px; height: 100px; border-radius: 50%; object-fit: cover; margin-bottom: 16px; }
    .role-title { font-family: 'Lora', serif; font-size: 20px; font-weight: 700; color: var(--brand-green); margin-top: 32px; margin-bottom: 16px; padding-bottom: 8px; border-bottom: 1px solid var(--border-color); }
    #employeeGrid .role-title:first-of-type { margin-top: 0; }
    .setting-item { display: flex; align-items: center; justify-content: space-between; padding: 20px 0; border-bottom: 1px solid var(--border-color); }
    .toggle-switch { position: relative; display: inline-block; width: 50px; height: 28px; }
    .toggle-switch input { opacity: 0; width: 0; height: 0; }
    .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 28px; }
    .slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
    input:checked + .slider { background-color: var(--primary-blue); }
    input:checked + .slider:before { transform: translateX(22px); }
    .view-details-btn { background-color: var(--primary-blue-light); color: var(--primary-blue); }
    .modal { display: none; position: fixed; z-index: 1001; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.6); animation: fadeIn 0.3s; }
    .modal-content { background-color: var(--card-bg-color); color: var(--text-dark); margin: 10vh auto; padding: 24px 32px; border: 1px solid var(--border-color); width: 90%; max-width: 600px; border-radius: 12px; position: relative; animation: slideIn 0.4s; }
    .close-button { color: var(--text-light); position: absolute; top: 15px; right: 20px; font-size: 28px; font-weight: bold; cursor: pointer; }
    .close-button:hover { color: var(--red); }
    #modal-title { font-family: 'Lora', serif; color: var(--brand-green); margin-bottom: 20px; font-size: 22px; }
    #modal-body { font-size: 15px; line-height: 1.6; white-space: pre-wrap; word-wrap: break-word; max-height: 60vh; overflow-y: auto; }
    @keyframes fadeIn { from {opacity: 0;} to {opacity: 1;} }
    @keyframes slideIn { from {transform: translateY(-50px); opacity: 0} to {transform: translateY(0); opacity: 1} }
    </style>
</head>
<body>
    <div id="toast-container"></div>
    <aside class="sidebar">
       <a href="index.html" class="logo"><img src="logo.png" alt="Lifewood Logo" class="logo-image"></a>
        <a class="nav-item active" data-page="dashboard"><i class='bx bxs-dashboard'></i><span>Dashboard</span></a>
        <a class="nav-item" data-page="employees"><i class='bx bxs-user-detail'></i><span>Employees</span></a>
        <a class="nav-item" data-page="settings"><i class='bx bxs-cog'></i><span>Settings</span></a>
        <button id="logoutBtn" class="nav-item logout-btn"><i class='bx bx-log-out'></i><span>Logout</span></button>
    </aside>

    <main class="main-content">
        <div id="dashboard-page" class="main-page active">
            <header class="page-header"><div class="greeting"><h1>Hello, Admin</h1><p id="currentDate"></p></div></header>
            <section class="dashboard-widgets">
                <div class="widget-card"><h3>Pending Applications</h3><p class="count" id="pendingCount">0</p></div>
                <div class="widget-card"><h3>Total Employees & Interns</h3><p class="count" id="acceptedCount">0</p></div>
                <div class="widget-card"><h3>Rejected Applicants</h3><p class="count" id="rejectedCount">0</p></div>
            </section>
            <section class="application-section">
                <div class="section-header"><h2>Application Management</h2><div class="tabs"><button class="tab-button active" data-tab="recent">Recent Pending</button><button class="tab-button" data-tab="pending">All Pending</button><button class="tab-button" data-tab="accepted">All Employees</button><button class="tab-button" data-tab="rejected">All Rejected</button></div></div>
                <div id="recent" class="tab-content active"><table class="application-table" id="recentTable"><thead><tr><th>Name</th><th>Role</th><th>Submitted</th><th>Actions</th></tr></thead><tbody></tbody></table><div class="no-apps-message" id="noRecentMessage"></div></div>
                <div id="pending" class="tab-content"><table class="application-table" id="pendingTable"><thead><tr><th>Name</th><th>Email</th><th>Role</th><th>Submitted</th><th>Details</th><th>Resume</th><th>Actions</th></tr></thead><tbody></tbody></table><div class="no-apps-message" id="noPendingMessage"></div></div>
                <div id="accepted" class="tab-content"><table class="application-table" id="acceptedTable"><thead><tr><th>Name</th><th>Email</th><th>Role</th><th>Submitted</th><th>Details</th><th>Resume</th></tr></thead><tbody></tbody></table><div class="no-apps-message" id="noAcceptedMessage"></div></div>
                <div id="rejected" class="tab-content"><table class="application-table" id="rejectedTable"><thead><tr><th>Name</th><th>Email</th><th>Role</th><th>Submitted</th><th>Details</th><th>Resume</th></tr></thead><tbody></tbody></table><div class="no-apps-message" id="noRejectedMessage"></div></div>
            </section>
        </div>
        <div id="employees-page" class="main-page">
            <header class="page-header"><div class="greeting"><h1>Employee Directory</h1><p>All active employees and interns, grouped by role.</p></div></header>
            <div class="widget-card">
                <div id="employeeGrid"></div>
                <div class="no-apps-message" id="noEmployeesMessage"></div>
            </div>
        </div>
        <div id="settings-page" class="main-page">
            <header class="page-header"><div class="greeting"><h1>Settings</h1><p>Customize your dashboard experience</p></div></header>
            <div class="widget-card"><div class="settings-section"><h2 class="section-title">Appearance</h2><div class="setting-item"><div class="label"><h4>Dark Mode</h4><p>Switch between light and dark themes.</p></div><label class="toggle-switch"><input type="checkbox" id="darkModeToggle"><span class="slider"></span></label></div><div class="setting-item"><div class="label"><h4>Compact Mode</h4><p>Reduce padding to see more on the screen.</p></div><label class="toggle-switch"><input type="checkbox" id="compactModeToggle"><span class="slider"></span></label></div></div><div class="settings-section"><h2 class="section-title">Notifications</h2><div class="setting-item"><div class="label"><h4>Email Notifications</h4><p>Receive summaries and alerts via email.</p></div><label class="toggle-switch"><input type="checkbox" id="emailNotifyToggle"><span class="slider"></span></label></div><div class="setting-item"><div class="label"><h4>Push Notifications</h4><p>Enable browser push notifications.</p></div><label class="toggle-switch"><input type="checkbox" id="pushNotifyToggle"><span class="slider"></span></label></div></div></div>
        </div>
    </main>

    <div id="detailsModal" class="modal">
        <div class="modal-content">
            <span class="close-button">Ã—</span>
            <h3 id="modal-title">Applicant Details</h3>
            <div id="modal-body"></div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.6.7/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.7/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.7/firebase-firestore-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDiUI6hSwt9OawThp5cg6quUuofhhVyCRQ",
            authDomain: "lifewoodtmf.firebaseapp.com",
            projectId: "lifewoodtmf",
            storageBucket: "lifewoodtmf.appspot.com",
            messagingSenderId: "125296626344",
            appId: "1:125296626344:web:e26fc1ce7ccf386642509d",
            measurementId: "G-XT2QXSC5PB"
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        const darkModeToggle = document.getElementById('darkModeToggle');
        const compactModeToggle = document.getElementById('compactModeToggle');
        const emailNotifyToggle = document.getElementById('emailNotifyToggle');
        const pushNotifyToggle = document.getElementById('pushNotifyToggle');

        document.addEventListener('DOMContentLoaded', () => {
            auth.onAuthStateChanged(user => {
                if (user && user.email.endsWith('@lifewood.com')) {
                    initializeDashboard();
                } else {
                    auth.signOut();
                    alert("Access Denied. Please log in with an authorized account.");
                    window.location.href = 'index.html'; // Or your login page
                }
            });
        });

        function initializeDashboard() {
            initializeSettings();
            setupAllTableListeners();
            displayCurrentDate();
            setupNavigation();
            setupModalListeners();
            document.getElementById('logoutBtn').addEventListener('click', () => auth.signOut());
        }

        // --- FULLY RESTORED SETTINGS LOGIC ---
        function showToast(message, type = 'info') { const container = document.getElementById('toast-container'); const toast = document.createElement('div'); toast.className = `toast ${type}`; let iconClass = 'bx-info-circle'; if (type === 'success') iconClass = 'bx-check-circle'; if (type === 'error') iconClass = 'bx-x-circle'; toast.innerHTML = `<i class='bx ${iconClass}'></i><span>${message}</span>`; container.appendChild(toast); setTimeout(() => { toast.remove(); }, 4000); }
        function initializeSettings() { if (localStorage.getItem('theme') === 'dark') { document.body.classList.add('dark-mode'); darkModeToggle.checked = true; } if (localStorage.getItem('layout') === 'compact') { document.body.classList.add('compact-mode'); compactModeToggle.checked = true; } emailNotifyToggle.checked = localStorage.getItem('emailNotifications') !== 'false'; if ('Notification' in window) { if (Notification.permission === 'granted') { pushNotifyToggle.checked = true; } else { pushNotifyToggle.checked = false; if (Notification.permission === 'denied') { pushNotifyToggle.disabled = true; } } } else { pushNotifyToggle.disabled = true; } }
        darkModeToggle.addEventListener('change', () => { document.body.classList.toggle('dark-mode'); localStorage.setItem('theme', darkModeToggle.checked ? 'dark' : 'light'); });
        compactModeToggle.addEventListener('change', () => { document.body.classList.toggle('compact-mode'); localStorage.setItem('layout', compactModeToggle.checked ? 'compact' : 'default'); showToast(`Compact mode ${compactModeToggle.checked ? 'enabled' : 'disabled'}.`); });
        emailNotifyToggle.addEventListener('change', () => { localStorage.setItem('emailNotifications', emailNotifyToggle.checked); showToast(`Email notifications turned ${emailNotifyToggle.checked ? 'ON' : 'OFF'}.`); });
        pushNotifyToggle.addEventListener('change', async () => { if (!pushNotifyToggle.checked) { showToast('Push notifications turned OFF.', 'error'); return; } if (!('Notification' in window)) { showToast('Push notifications are not supported.', 'error'); pushNotifyToggle.disabled = true; return; } try { const permission = await Notification.requestPermission(); if (permission === 'granted') { showToast('Push notifications enabled!', 'success'); new Notification('Lifewood Admin', { body: 'You will now receive real-time updates!' }); } else if (permission === 'denied') { showToast('Push notifications were blocked.', 'error'); pushNotifyToggle.disabled = true; pushNotifyToggle.checked = false; } else { showToast('Notification permission not granted.'); pushNotifyToggle.checked = false; } } catch (error) { showToast('An error occurred.', 'error'); pushNotifyToggle.checked = false; } });

        // --- FULLY RESTORED NAVIGATION LOGIC ---
        function setupNavigation() {
            const navItems = document.querySelectorAll('.sidebar .nav-item');
            const mainPages = document.querySelectorAll('.main-page');
            navItems.forEach(item => {
                if (!item.classList.contains('logout-btn')) {
                    item.addEventListener('click', () => {
                        navItems.forEach(i => i.classList.remove('active'));
                        item.classList.add('active');
                        const pageId = item.dataset.page + '-page';
                        mainPages.forEach(page => page.classList.toggle('active', page.id === pageId));
                    });
                }
            });
            const tabs = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(item => item.classList.remove('active'));
                    tab.classList.add('active');
                    tabContents.forEach(content => content.classList.toggle('active', content.id === tab.dataset.tab));
                });
            });
        }
        
        function setupAllTableListeners() { ['pending', 'accepted', 'rejected'].forEach(status => setupTableListener(status)); }
        
        function setupTableListener(status) {
            db.collection('applications').where('status', '==', status).orderBy('submittedAt', 'desc')
              .onSnapshot(snapshot => {
                  const countElement = document.getElementById(`${status}Count`);
                  if (countElement) countElement.textContent = snapshot.size;

                  if (status === 'accepted') {
                      populateTable(snapshot, 'acceptedTable', 'noAcceptedMessage');
                      populateEmployeeGrid(snapshot); // This call is now correct
                  } else if (status === 'pending') {
                      populateTable(snapshot, 'pendingTable', 'noPendingMessage');
                      populateRecentPendingTable(snapshot);
                  } else {
                      populateTable(snapshot, 'rejectedTable', 'noRejectedMessage');
                  }
              }, error => console.error(`Error fetching '${status}' applications: Check Firestore indexes.`, error));
        }
        
        function populateTable(snapshot, tableId, messageId) {
            const table = document.getElementById(tableId);
            const tableBody = table.querySelector('tbody');
            const noAppsMessage = document.getElementById(messageId);
            tableBody.innerHTML = '';
            
            if (snapshot.empty) {
                noAppsMessage.style.display = 'block';
                table.style.display = 'none';
                return;
            }
            noAppsMessage.style.display = 'none';
            table.style.display = 'table';
            
            snapshot.forEach(doc => {
                const app = doc.data();
                const row = tableBody.insertRow();
                const fullName = `${app.firstName||''} ${app.lastName||''}`.trim();
                const detailsContent = `Full Name: ${fullName}\nEmail: ${app.email}\nAge: ${app.age || 'N/A'}\nDegree: ${app.degree || 'N/A'}\n\nExperience:\n${app.experience || 'No experience provided.'}`;
                const detailsButtonHtml = `<td><button class="action-btn view-details-btn" data-name="${fullName}" data-details="${encodeURIComponent(detailsContent)}">View</button></td>`;
                const actionsHtml = app.status === 'pending' ? `<td><button class="action-btn accept-btn" data-id="${doc.id}">Accept</button><button class="action-btn reject-btn" data-id="${doc.id}">Reject</button></td>` : '';
                
                let rowHtml = `
                    <td>${fullName}</td>
                    <td><a href="mailto:${app.email}">${app.email}</a></td>
                    <td>${app.project||'N/A'}</td>
                    <td>${app.submittedAt?.toDate().toLocaleString() || 'N/A'}</td>
                    ${detailsButtonHtml}
                    <td><a href="${app.resumeLink}" target="_blank" rel="noopener noreferrer">Link</a></td>
                    ${actionsHtml}
                `;
                if (tableId === 'acceptedTable' || tableId === 'rejectedTable') {
                     rowHtml = `<td>${fullName}</td><td><a href="mailto:${app.email}">${app.email}</a></td><td>${app.project||'N/A'}</td><td>${app.submittedAt?.toDate().toLocaleString() || 'N/A'}</td>${detailsButtonHtml}<td><a href="${app.resumeLink}" target="_blank" rel="noopener noreferrer">Link</a></td>`;
                }
                row.innerHTML = rowHtml;
            });
        }
        
        function populateRecentPendingTable(snapshot) {
            const tableBody = document.getElementById('recentTable').querySelector('tbody');
            tableBody.innerHTML = '';
            const recentDocs = snapshot.docs.slice(0, 5);
            if (recentDocs.length === 0) {
                document.getElementById('noRecentMessage').style.display = 'block';
                document.getElementById('recentTable').style.display = 'none';
                return;
            }
            document.getElementById('noRecentMessage').style.display = 'none';
            document.getElementById('recentTable').style.display = 'table';
            recentDocs.forEach(doc => {
                const app = doc.data();
                const row = tableBody.insertRow();
                row.innerHTML = `<td>${app.firstName||''} ${app.lastName||''}</td><td>${app.project||'N/A'}</td><td>${app.submittedAt?.toDate().toLocaleString()||'N/A'}</td><td><button class="action-btn accept-btn" data-id="${doc.id}">Accept</button><button class="action-btn reject-btn" data-id="${doc.id}">Reject</button></td>`;
            });
        }

        // --- FULLY RESTORED EMPLOYEE GRID LOGIC ---
        function populateEmployeeGrid(snapshot) {
            const mainContainer = document.getElementById('employeeGrid');
            const message = document.getElementById('noEmployeesMessage');
            mainContainer.innerHTML = ''; 

            if (snapshot.empty) {
                message.textContent = 'No employees found. Accept applications to add them here.';
                message.style.display = 'block';
                mainContainer.style.display = 'none';
                return;
            }
            message.style.display = 'none';
            mainContainer.style.display = 'block';

            const employeesByRole = {};
            snapshot.forEach(doc => {
                const employee = doc.data();
                const role = employee.project || 'Uncategorized';
                if (!employeesByRole[role]) employeesByRole[role] = [];
                employeesByRole[role].push(employee);
            });

            Object.keys(employeesByRole).sort().forEach(role => {
                const roleHeader = document.createElement('h3');
                roleHeader.className = 'role-title';
                roleHeader.textContent = role;
                mainContainer.appendChild(roleHeader);

                const roleGrid = document.createElement('div');
                roleGrid.className = 'employee-grid';

                employeesByRole[role].forEach(employee => {
                    const card = document.createElement('div');
                    card.className = 'widget-card employee-card';
                    const placeholderImg = `https://i.pravatar.cc/100?u=${employee.email}`;
                    card.innerHTML = `<img src="${placeholderImg}" alt="Profile Picture"><h4>${employee.firstName || ''} ${employee.lastName || ''}</h4><p>${employee.email || 'N/A'}</p>`;
                    roleGrid.appendChild(card);
                });
                mainContainer.appendChild(roleGrid);
            });
        }

        function displayCurrentDate() { document.getElementById('currentDate').textContent = `It's ${new Date().toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}`; }
        async function handleApplication(appId, newStatus) { try { await db.collection('applications').doc(appId).update({ status: newStatus }); showToast(`Application ${newStatus}.`, 'success'); } catch (error) { console.error("Error updating status:", error); showToast(`Error updating application.`, 'error'); } }
        
        function setupModalListeners() {
            const modal = document.getElementById('detailsModal');
            if (!modal) return;
            const closeBtn = modal.querySelector('.close-button');
            const closeModal = () => modal.style.display = "none";
            closeBtn.onclick = closeModal;
            window.onclick = (event) => { if (event.target == modal) closeModal(); };
            document.addEventListener('keydown', (event) => { if (event.key === "Escape") closeModal(); });
        }

        document.querySelector('.main-content').addEventListener('click', e => {
            if (e.target.classList.contains('accept-btn')) handleApplication(e.target.dataset.id, 'accepted');
            if (e.target.classList.contains('reject-btn')) handleApplication(e.target.dataset.id, 'rejected');
            if (e.target.classList.contains('view-details-btn')) {
                const modal = document.getElementById('detailsModal');
                const modalTitle = document.getElementById('modal-title');
                const modalBody = document.getElementById('modal-body');
                const name = e.target.getAttribute('data-name');
                const details = decodeURIComponent(e.target.getAttribute('data-details'));
                modalTitle.innerText = `Details for ${name}`;
                modalBody.innerText = details;
                modal.style.display = 'block';
            }
        });
    </script>
</body>
</html>